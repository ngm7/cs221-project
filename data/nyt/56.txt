The federal office said McKinsey had tried to make it appear as if the investment unit’s decisions were made by independent staff members, avoiding any mention that Mr. Garcia received regular reports on its decisions and ratified them.

“McKinsey’s misleading representation and lack of transparency regarding Mr. Garcia’s role undermines the very purpose” of the bankruptcy disclosure rules, Mr. Fitzgerald wrote.

In a statement, McKinsey said its disclosures “fully meet the terms of the U.S. Bankruptcy Code.”

“We have been transparent about the connections we were disclosing and the process utilized to identify those connections,” the company said. It added, “As always, McKinsey is committed to taking any guidance the U.S. trustee deems appropriate to give.”

McKinsey has made repeated statements, in court and on its website, that its investment division is walled off from its consulting business. That, McKinsey has said, precludes any possibility that the investments could taint the consultants’ advice.

Since there is no risk of undue influence, McKinsey has said, it does not have to disclose its investment activities to the court when it works on a bankruptcy case.

That argument was eventually challenged by Jay Alix, a retired bankruptcy restructuring expert. During the Alpha Natural Resources bankruptcy, Mr. Alix formed an investment partnership and became an unsecured creditor, giving him standing to challenge McKinsey over its disclosures. He eventually moved to have the bankruptcy reopened for an investigation of potential fraud.